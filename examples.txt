SELECT
    count(*) AS commits,
    count(CASE WHEN strftime('%H',author_when)='0' THEN 1 END) AS '0',
    count(CASE WHEN strftime('%H',author_when)='1' THEN 1 END) AS '1',
    count(CASE WHEN strftime('%H',author_when)='2' THEN 1 END) AS '2',
    count(CASE WHEN strftime('%H',author_when)='3' THEN 1 END) AS '3',
    count(CASE WHEN strftime('%H',author_when)='4' THEN 1 END) AS '4',
    count(CASE WHEN strftime('%H',author_when)='5' THEN 1 END) AS '5',
    count(CASE WHEN strftime('%H',author_when)='6' THEN 1 END) AS '6',
    count(CASE WHEN strftime('%H',author_when)='7' THEN 1 END) AS '7',
    count(CASE WHEN strftime('%H',author_when)='8' THEN 1 END) AS '8',
    count(CASE WHEN strftime('%H',author_when)='9' THEN 1 END) AS '9',
    count(CASE WHEN strftime('%H',author_when)='10' THEN 1 END) AS '10',
    count(CASE WHEN strftime('%H',author_when)='11' THEN 1 END) AS '11',
    count(CASE WHEN strftime('%H',author_when)='12' THEN 1 END) AS '12',
    count(CASE WHEN strftime('%H',author_when)='13' THEN 1 END) AS '13',
    count(CASE WHEN strftime('%H',author_when)='14' THEN 1 END) AS '14',
    count(CASE WHEN strftime('%H',author_when)='15' THEN 1 END) AS '15',
    count(CASE WHEN strftime('%H',author_when)='16' THEN 1 END) AS '16',
    count(CASE WHEN strftime('%H',author_when)='17' THEN 1 END) AS '17',
    count(CASE WHEN strftime('%H',author_when)='18' THEN 1 END) AS '18',
    count(CASE WHEN strftime('%H',author_when)='19' THEN 1 END) AS '19',
    count(CASE WHEN strftime('%H',author_when)='20' THEN 1 END) AS '20',
    count(CASE WHEN strftime('%H',author_when)='21' THEN 1 END) AS '21',
    count(CASE WHEN strftime('%H',author_when)='22' THEN 1 END) AS '22',
    count(CASE WHEN strftime('%H',author_when)='23' THEN 1 END) AS '23',
    author_email
FROM commits GROUP BY author_email ORDER BY commits


SELECT
    count(*) AS commits,
    SUM(CASE WHEN strftime('%H',author_when)='0' THEN additions END) AS '+0',
    SUM(CASE WHEN strftime('%H',author_when)='0' THEN deletions END) AS '-0',
    SUM(CASE WHEN strftime('%H',author_when)='1' THEN additions END) AS '+1',
    SUM(CASE WHEN strftime('%H',author_when)='1' THEN deletions END) AS '-1',
    SUM(CASE WHEN strftime('%H',author_when)='2' THEN additions END) AS '+2',
    SUM(CASE WHEN strftime('%H',author_when)='2' THEN deletions END) AS '-2',
    SUM(CASE WHEN strftime('%H',author_when)='3' THEN additions END) AS '+3',
    SUM(CASE WHEN strftime('%H',author_when)='3' THEN deletions END) AS '-3',
    SUM(CASE WHEN strftime('%H',author_when)='4' THEN additions END) AS '+4',
    SUM(CASE WHEN strftime('%H',author_when)='4' THEN deletions END) AS '-4',
    SUM(CASE WHEN strftime('%H',author_when)='5' THEN additions END) AS '+5',
    SUM(CASE WHEN strftime('%H',author_when)='5' THEN deletions END) AS '-5',
    SUM(CASE WHEN strftime('%H',author_when)='6' THEN additions END) AS '+6',
    SUM(CASE WHEN strftime('%H',author_when)='6' THEN deletions END) AS '-6',
    SUM(CASE WHEN strftime('%H',author_when)='7' THEN additions END) AS '+7',
    SUM(CASE WHEN strftime('%H',author_when)='7' THEN deletions END) AS '-7',
    SUM(CASE WHEN strftime('%H',author_when)='8' THEN additions END) AS '+8',
    SUM(CASE WHEN strftime('%H',author_when)='8' THEN deletions END) AS '-8',
    SUM(CASE WHEN strftime('%H',author_when)='9' THEN additions END) AS '+9',
    SUM(CASE WHEN strftime('%H',author_when)='9' THEN deletions END) AS '-9',
    SUM(CASE WHEN strftime('%H',author_when)='10' THEN additions END) AS '+10',
    SUM(CASE WHEN strftime('%H',author_when)='10' THEN deletions END) AS '-10',
    SUM(CASE WHEN strftime('%H',author_when)='11' THEN additions END) AS '+11',
    SUM(CASE WHEN strftime('%H',author_when)='11' THEN deletions END) AS '-11',
    SUM(CASE WHEN strftime('%H',author_when)='12' THEN additions END) AS '+12',
    SUM(CASE WHEN strftime('%H',author_when)='12' THEN deletions END) AS '-12',
    SUM(CASE WHEN strftime('%H',author_when)='13' THEN additions END) AS '+13',
    SUM(CASE WHEN strftime('%H',author_when)='13' THEN deletions END) AS '-13',
    SUM(CASE WHEN strftime('%H',author_when)='14' THEN additions END) AS '+14',
    SUM(CASE WHEN strftime('%H',author_when)='14' THEN deletions END) AS '-14',
    SUM(CASE WHEN strftime('%H',author_when)='15' THEN additions END) AS '+15',
    SUM(CASE WHEN strftime('%H',author_when)='15' THEN deletions END) AS '-15',
    SUM(CASE WHEN strftime('%H',author_when)='16' THEN additions END) AS '+16',
    SUM(CASE WHEN strftime('%H',author_when)='16' THEN deletions END) AS '-16',
    SUM(CASE WHEN strftime('%H',author_when)='17' THEN additions END) AS '+17',
    SUM(CASE WHEN strftime('%H',author_when)='17' THEN deletions END) AS '-17',
    SUM(CASE WHEN strftime('%H',author_when)='18' THEN additions END) AS '+18',
    SUM(CASE WHEN strftime('%H',author_when)='18' THEN deletions END) AS '-18',
    SUM(CASE WHEN strftime('%H',author_when)='19' THEN additions END) AS '+19',
    SUM(CASE WHEN strftime('%H',author_when)='19' THEN deletions END) AS '-19',
    SUM(CASE WHEN strftime('%H',author_when)='20' THEN additions END) AS '+20',
    SUM(CASE WHEN strftime('%H',author_when)='20' THEN deletions END) AS '-20',
    SUM(CASE WHEN strftime('%H',author_when)='21' THEN additions END) AS '+21',
    SUM(CASE WHEN strftime('%H',author_when)='21' THEN deletions END) AS '-21',
    SUM(CASE WHEN strftime('%H',author_when)='22' THEN additions END) AS '+22',
    SUM(CASE WHEN strftime('%H',author_when)='22' THEN deletions END) AS '-22',
    SUM(CASE WHEN strftime('%H',author_when)='23' THEN additions END) AS '+23',
    SUM(CASE WHEN strftime('%H',author_when)='23' THEN deletions END) AS '-23',
    author_email
FROM commits GROUP BY author_email ORDER BY commits

SELECT
    SUM(additions) AS all_add,
    SUM(deletions) AS all_del,
    (SUM(additions))*100/(SELECT SUM(additions) FROM commits) AS pct_add,
    (SUM(deletions))*100/(SELECT SUM(deletions) FROM commits) AS pct_del,
    author_email
FROM commits GROUP BY author_email ORDER BY all_add

